{% extends "base.html" %}

{% block title %}Editar Vulnerabilidade{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">Editar Vulnerabilidade em "{{ app.name }}"</h2>
    <form method="POST">
        <div class="mb-3">
            <label for="description" class="form-label">Descrição</label>
            <textarea name="description" id="description" class="form-control" rows="3" required>{{ vuln.description }}</textarea>
        </div>
        <div class="mb-3">
            <label for="severity" class="form-label">Severidade</label>
            <select name="severity" id="severity" class="form-select">
                {% for level in ['baixa', 'média', 'alta', 'crítica'] %}
                    <option value="{{ level }}" {% if vuln.severity == level %}selected{% endif %}>{{ level.capitalize() }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label for="status" class="form-label">Status</label>
            <select name="status" id="status" class="form-select">
                {% for s in ['aberto', 'em andamento', 'resolvido'] %}
                    <option value="{{ s }}" {% if vuln.status == s %}selected{% endif %}>{{ s.capitalize() }}</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-light">Salvar Alterações</button>
        <a href="{{ url_for('protected.app_detail', id=app.id) }}" class="btn btn-outline-light ms-2">Cancelar</a>
    </form>
</div>
{% endblock %}