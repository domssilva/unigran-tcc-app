from models import db
from models.vulnerability import Vulnerability

def create_vulnerability(description, severity, status, application):
    vuln = Vulnerability(
        description=description,
        severity=severity,
        status=status,
        application_id=application.id
    )
    db.session.add(vuln)
    application.vulnerabilities_count += 1
    db.session.commit()
    return vuln

def update_vulnerability(vuln, description, severity, status):
    vuln.description = description
    vuln.severity = severity
    vuln.status = status
    db.session.commit()
    return vuln